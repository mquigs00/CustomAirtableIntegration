# CustomAirtableIntegration

Goal:
To create a middleware function that will receive a webhook with a client's digital form submission, transform the data to fit the Airtable requirements, and insert the Client to the table if they are not already added.

Story:
This project was inspired by my work re-designing the data system for an organization that was previously using paper intake forms to gather client data with 30+ mandatory fields. Clients would have to fill out the paper form at the beginning of the first appointment, wasting valuable time that they could be getting their case started with the employee. After appointments, the employee would then have to manually enter the clients data to create a new client in the case management system. I set up
a cost-effective subscription with Fillout.com so clients could efficiently fill out all of their data before coming into the
appointment so all appointment time could be effectively used. Fillout.come would map the clients answers to the original client intake form so that a PDF copy could be saved for record keeping and additional info that the CMS did not require. I then wrote this middleware function to receive the form submission, transform the values and add any necessary data to fit the CMS Client form requirements, and insert the new client. Some field's answer choices needed to be transformed because the answers provided in the Case Management System were not easily understandable for client's, and a counselor would not be present to answer them before the client came in for their appointment. In order to avoid adding duplicate clients who have already had cases with the organization, the function initially makes an API request to the Client table to see if a client with the same first name, last name, date of birth, and last four digits of SSN exists. If not, the function continues with the transformation and insertion of the client data.

Value:
After each appointment, counselors at the organization would have 30 minutes to add all of their clients data. Furthermore, because the client did not already exist in the Case Management System when they came for an appointment, counselors could not write their notes in the CMS case file so they would write their notes outside of the Case Management System (in Excel, Word, etc.) and then intend to transfer the notes once the client left and the counselor created the Client and opened a case. Of course, counselors would often get pulled into other meetings or appointments and forget to add these notes in the CMS, leaving the organization at risk during audits. By having the client already created in the system, the counselors could immediately open a case for that client and record notes and financial details about the client, reducing data loss.
Some online form builders like Jotform already have native Salesforce integration for free. This is still severely limited because the Jotform free plan only allows for 100 monthly submissions and only 10 of those can have signatures. Furthermore, if you have a team sharing forms, you need a Jotform enterprise account which is thousands of dollars.
Fillout, on the other hand, has a Free plan with 1,000 submissions a month and allows for multiple users. In order to have signatures, you just need the $15/month Starter plan which also bumps you up to 2,000 responses a month. Fillout's pricing is flipped though. While they offer unlimited teammates, 2000 submissions/month, and eSignatures for just $15/month, their native Salesforce integration requires their $250/month Enterprise plan. This is where the value of this middleware function comes in. This function allows you to get the best of Fillout plus Salesforce integration for a couple dollars a month. I used an AWS Lambda function and API Gateway which gives you 1 million free calls per month. The only cost in AWS is the 50 cents per month for the webhook secret, CMS API key secret, and Opencage api key secrets, for a total of $1.50 per month.

Challenges:
1. The CMS that I was working with on this project not only required the Street Address, City, State, and Zipcode, but also the County in a drop down input field with thousands of county options. When using the application, the county value would autofill once the other address components were entered. This made sending the data via an API much more complicated, because clients could not be trusted to type in their county as it might cause an error if their answer didn't perfectly match the CMS County input options (Ex: Client enters "Montgomery" or "Montco" --> CMS option is "Montgomery County" would cause an error for no exact matching option). I decided to not have the client enter their county because they might mispell or abbreviate, so instead I would use their address to call OpenCage API to get the official county name.